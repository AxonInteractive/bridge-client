<DOCTYPE html>
<html>
  <head>
    <title>AxonBridge Example</title>
  </head>
  <body>
    <script src="lib/bridge-client.js"></script>
    <script type="text/javascript">
      
      // AxonBridge Initialization
      // This function bootstraps the module with the required constructor arguments.
      ( function () {
      
          // =====
          // SETUP
          // =====

          // Link to your API by supplying appropriate constructor arguments:
          //                ================ API URL ================= TIMEOUT
          AxonBridge.build( 'https://192.168.2.34:3000/api/1.0/', 10000 );

          // Hook up callbacks for events you're interested in:
          AxonBridge.loginFailureCallback = function ( user, jqXHR, textStatus, errorThrown ) {
            console.log( "Request failed >> " + textStatus );
            console.log( errorThrown );
            console.log( jqXHR );
          };
          AxonBridge.loginSuccessCallback = function ( user, data, textStatus, jqXHR ) {
            console.log( "Request successful >> " + data );
            console.log( data );
            console.log( jqXHR );
          };
          AxonBridge.logoutCallback = function ( user ) {
            console.log( "Logging out...");
          };
          AxonBridge.requestCallback = function ( user, method, resource, payload ) {
            console.log( "Request >> " + method + " resource " + resource + " = " + JSON.stringify( payload ) );
          };

          // =====
          // USAGE
          // =====

          // Send a log in request to fetch a user object from your API:
          AxonBridge.login( 'first@domain.com', 'gr33np3pp3r' );

          // Subsequest requests will sent using the logged-in user to authenticate:
          AxonBridge.request( 'PUT', 'actions', {

              'type': 'view',
              'target': 'pretest',
              'time': new Date() // Parses into ISO-8061 date string format, thanks to json3.js.

          } ).done( function ( data, textStatus, jqXHR ) {

          // AxonBridge.request() returns a jqXHR instance, which implements the
          // JavaScript Promise interface, so you can asynchronously handle responses as:
          
          // Success...
          console.log( "Status: " + textStatus );

          } ).fail( function ( jqXHR, textStatus, errorThrown ) {

          // Failure...
          console.log( "Status: " + textStatus );

          } ).always( function () {

            // The user can log out when they're done, if they like.
            AxonBridge.logout();

          } );

      } )();
      
    </script>
  </body>
</html>